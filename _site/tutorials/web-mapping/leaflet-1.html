<!DOCTYPE html>
<html>
<head>
  <title>GISCollective</title>
  <meta http-equiv="content-type" charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:300,400,700' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Roboto:100,300,600,900' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>
  <link href="/public/style.css" rel="stylesheet">
</head>
<body>
  <div id="navbar">
  <div class="wrapper">
    <div id="branding">
      <div id="site-title"><h1><a href="/" title="GISC" rel="home">GISC</a></h1></div>
    </div>
    <nav id="nav">
      <button class="nav-expand"><i class="icon hamburger"></i></button>
      <ul id="menu-gisc-2" class="menu">
        <li id="menu-item-111" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-111"><a href="/">Home</a></li>
        <li id="menu-item-101" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-101"><a href="/tutorials/">Tutorials</a></li>
        <li id="menu-item-192" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-192"><a href="/resources/">Resources</a></li>
        <li id="menu-item-108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-108"><a href="/about/">About</a></li>
      </ul>
    </nav>
  </div>
</div>
  <div class="wrapper hfeed">
  <div id="container">

<article id="content">
  <div class="post type-post status-publish format-standard hentry category-data">
    <h2 class="entry-title">
      <a href="/tutorials/web-mapping/leaflet-1" title="Leaflet: Setup &#038; Basemap" rel="bookmark">Leaflet: Setup &#038; Basemap</a>
    </h2>

    <div class="entry-content">
      <p><em>By Max Axler, Sam Matthews, Chandler Sterling, and Matt McKenna</em></p>

<p><strong>UPDATE 8/7/2013</strong> The full tutorial has been updated to reflect the most recent stable version of leaflet.js – version 0.6.4. The tutorial explains how to build an HTML framework for leaflet and now has working examples on bl.ocks.org.</p>

<p><strong>UPDATE 8/5/2013</strong> We have an updated example for our Leaflet 1 tutorial thanks to <a href="https://github.com/mpmckenna8">Matthew McKenna</a>. It is my understanding that updates have been made, rendering our tutorials obsolete. See a complete example of establishing a basemap using Leaflet at Matt’s Github repository: https://github.com/mpmckenna8/leaflettuts</p>

<hr />

<p>There are many ways of putting spatial data online ranging from out of the box solutions such as Google’s Fusion Tables or Adobe Flash, to javascript libraries like Google Maps API. While the industry standard for javascript libraries has become Google Maps API, there are many reasons to seek out open alternatives. First, open javascript libraries are not subject to changing payment plans. Just recently, Google announced plans to charge on a per view basis after map views exceed a certain number. This tutorial will explain the set-up of a basic leaflet map.</p>

<h2 id="step-1-html-framework">Step 1: HTML Framework</h2>

<p>The first step to setting up any javascript web map is to put together the basic HTML framework. Using what you’ve learned from previous tutorials create the standard, and elements. Next, create a div with the ID of “map”. You will use this div as a container for the map object, which you will instantiate using the leaflet library.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;div id = “map”&gt;&lt;/div&gt;
</code></pre>
</div>

<p>You will also need to define some styling for the map <code class="highlighter-rouge">&lt;div&gt;</code>. This should be done through CSS styles in your <code class="highlighter-rouge">&lt;head&gt;</code> or in a separate <code class="highlighter-rouge">style.css</code> sheet.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;style&gt;
#map {
    width:900px;
    height:500px;
}
&lt;/style&gt;
</code></pre>
</div>

<p>When you have completed this setup code, create a new folder to house your web map and save the document as <code class="highlighter-rouge">index.html</code>.</p>

<h2 id="step-2-source--setup">Step 2: Source &amp; Setup</h2>

<p>The next step is to download the leaflet source code and reference it in your html document. Point your web browser to <a href="http://leafletjs.com">leafletjs.com</a> and download the latest stable version of leaflet (currently version 0.6.4) then move the contents of the folder into the same directory where you are storing the index.html document. Rename the downloaded folder leaflet to make it easier to reference in your code.</p>

<p><img src="https://s3.amazonaws.com/gisc/wordpressImages/leaflet1.jpg" alt="leaflet directory structure" /></p>

<p>Now that you have copies of the leaflet source code you need to referece the leaflet stylesheet and javascript files to your index page. To accomplish this place links within the head section of the document as follows.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;link rel="stylesheet" href="leaflet/dist/leaflet.css" /&gt;
&lt;!--[if lte IE 8]&gt;
    &lt;link rel="stylesheet" href="leaflet/dist/leaflet.ie.css" /&gt;
&lt;![endif]--&gt;
&lt;script type="text/javascript" src="leaflet/dist/leaflet.js"&gt;&lt;/script&gt;
</code></pre>
</div>

<p>Note: Since versions of Internet Explorer are outdated (anything less than IE9) they will require a separate stylesheet. To make your map compatible with older versions of IE, be sure to include the <code class="highlighter-rouge">&lt;!--[if]&gt;</code> statement after the first CSS reference.</p>

<h2 id="step-3-script">Step 3: Script</h2>

<p>The final step to creating your basic Leaflet map is write the script that loads your map. Now that you have created a space in the html for your map to sit, and connected a series of functions via the leaflet library, you can call these functions to create your interactive map. The first thing you should do, is create a new script within the head of the document.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;script type="text/javascript"&gt;
  // your javascript code 
&lt;/script&gt;
</code></pre>
</div>

<p>Next, it is good practice to wrap your entire map script in the function:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>window.onload = function () { };
</code></pre>
</div>

<p>This ensures that your map script won’t run until the web page structure has loaded, preventing leaflet from trying to load your map in a non-existent div. First we’ll set some parameters for the basemap such as the center point and the zoom level. The following will also run the <code class="highlighter-rouge">L.map</code> function, which instantiates your map on a specified id (typically a div defined in your css).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var map = L.map('map').setView([43.07265,-89.400929], 10);
</code></pre>
</div>

<p>Now you need to tell leaflet what type of tile layer to use. Tiles are simply a series of png images that make up the basemap of any javascript based webmap. Tiling allows your web browser to load base maps quickly at a variety of scales. Since leaflet is designed to be open and modular, you can load these tiles from a number of sources (such as google, tilemill, open street maps). We’ll use Open Street Maps here:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&amp;copy; &lt;a href="http://osm.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'
}).addTo(map); 
</code></pre>
</div>

<p>This segment of code pulls the images from OSM’s tile server based on the X,Y, Z coordinates of your current map pane. In short, your script should look something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;script type="text/javascript"&gt;// 
    window.onload = function () {
        var map = L.map('map').setView([43.07265,-89.400929], 10);
        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&amp;copy; &lt;a href="http://osm.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'
        }).addTo(map);
    };
&lt;/script&gt;
</code></pre>
</div>

<p>Test it out in a browser by double clicking your index page or opening it on a localhost server. If you are having problems check out the completed code example on <strong><a href="http://bl.ocks.org/svmatthews/6175629">bl.ocks</a></strong>.</p>

<p><strong>Creating a Marker:</strong> Once you’ve instantiated your map object – you can add data in a variety of ways. The simplest is to manually geocode points. The code for this process can be found in the documentation portion of leaflet’s website. Basically all you have to do is specify a latitude and longitude, append it to leaflet’s <code class="highlighter-rouge">L.marker</code> function, and pass the <code class="highlighter-rouge">.bindPopup()</code> and <code class="highlighter-rouge">.openPopup()</code> functions</p>

<div class="highlighter-rouge"><pre class="highlight"><code>L.marker([43.07265,-89.400929]).addTo(map)
    .bindPopup('Science Hall&lt;br&gt;Where the GISC was born.')
    .openPopup();
</code></pre>
</div>

<p>This will automatically open the popup on the page load. See the complete code example on <strong><a href="http://bl.ocks.org/svmatthews/6175692">bl.ocks</a></strong>.</p>

<p><a href="http://giscollective.org/tutorials/web-mapping/leaflet-2">Part 2: Bringin in data as a geoJSON –&gt;</a></p>

    </div>
  </div>
</article>

<aside id="sidebar">
  <p id="site-description">Collective spatial learning from students and professionals</p>
  <div id="primary" class="widget-area">

    <h3 class="widget-title">Categories</h3>
    <ul>
      <li>list of categories</li>
    </ul>

    <h3 class="widget-title">Recent posts</h3>
    <ul>
      <li>list of recent posts</li>
    </ul>

    <h3 class="widget-title">Archives</h3>
    <ul>
      <li>something that resembles the archives</li>
    </ul>
  </div>
</aside>

<div class="clear"></div>
</div>
<footer>
<div id="copyright">GISCollective.org, 2016</div>
</footer>
</div>
<script src="/public/gisc.js"></script>
</body>
</html>